{"version":3,"sources":["config.ts","nmb.ts","utils.js","components/main.js","components/image-viewer.js","App.js","components/thread.js","serviceWorker.js","index.js"],"names":["Config","theme","createMuiTheme","palette","primary","main","teal","secondary","red","Nmb","fid","page","axios","get","API_SHOWF","tid","API_THREAD","NMB_HOST","HOST","API_GET_FORUM_LIST","API_SEARCH","CDN_IMG","CDN_THUMB","moment","locale","months","split","monthsShort","weekdays","weekdaysShort","weekdaysMin","longDateFormat","LT","LTS","L","LL","LLL","LLLL","l","ll","lll","llll","meridiemParse","meridiemHour","hour","meridiem","minute","isLower","hm","calendar","sameDay","nextDay","nextWeek","lastDay","lastWeek","sameElse","dayOfMonthOrdinalParse","ordinal","number","period","relativeTime","future","past","s","ss","m","mm","h","hh","d","dd","M","MM","y","yy","week","dow","doy","utime","src","color","test","strHex","colorArr","replace","i","length","hex","Number","toString","String","Alert","props","elevation","variant","ListItemLink","ListItem","button","component","ScrollTop","children","window","trigger","useScrollTrigger","target","undefined","disableHysteresis","threshold","Zoom","in","onClick","event","anchor","ownerDocument","document","querySelector","scrollIntoView","behavior","block","role","style","position","bottom","right","Main","utils","toggleDrawer","bind","addOldThreads","saveNowThreads","fetchDone","addChosedOldThreads","state","drawerOpen","isLoading","isImageOpen","threads","localNowThreads","imageLoaded","muiChoise","checkedThreads","styles","cardHead","display","width","flexWrap","justifyContent","grey","cardHeadCookie","cardHeadTime","marginLeft","cardContentImage","marginRight","cardImage","maxWidth","maxHeight","cardContent","cardText","menuButton","title","flexGrow","oldThreads","JSON","parse","localStorage","getItem","setItem","stringify","this","setState","pre","id","tmp","_","cloneDeep","Object","keys","forEach","key","remove","thread","nowThreads","fetchData","data","now","Date","sort","a","b","getThreadList","then","console","log","nowThreadsIds","j","tmp2","push","preParse","sortNowThreads","tmpStyles","admin","imgRes","img","alt","ext","stopPropagation","history","btoa","className","muiChoiseBox","Checkbox","defaultChecked","onChange","checked","Paper","padding","userid","replyCount","dangerouslySetInnerHTML","__html","content","progress","LinearProgress","indexOf","createThreadCard","empty","severity","reverse","Drawer","open","onClose","List","aria-label","href","ListItemIcon","ListItemText","AppBar","Toolbar","IconButton","edge","Typography","deleteOldThreads","location","reload","marginTop","Container","Accordion","AccordionSummary","expandIcon","aria-controls","heading","Button","onFocus","AccordionDetails","Fab","size","React","Component","ImageViewer","routeParams","url","atob","match","params","_url","height","go","margin","Thread","lineHeight","subTitle","replys","startsWith","options","styleQuote","borderLeft","background","element","createReply","noShowDivider","noShowId","showJump","$","ReactDOM","render","html","getTheard","response","po","reply","click","nodeName","text","targetId","parseQuote","createNativeQuote","off","setTimeout","fontWeight","contentDom","contentHtml","divider","Divider","light","r","gutterBottom","Boolean","hostname","Array","prototype","val","index","splice","ThemeProvider","path","path_prefix","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"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","file":"static/js/main.9881309e.chunk.js","sourcesContent":["import React from 'react'\r\nimport { createMuiTheme, ThemeProvider } from '@material-ui/core/styles';\r\nimport { teal, red } from '@material-ui/core/colors';\r\n\r\nexport class Config {\r\n  public static theme = createMuiTheme({\r\n    palette: {\r\n      primary: {\r\n        main: teal[500],\r\n      },\r\n      secondary: {\r\n        main: red[500],\r\n      },\r\n    },\r\n  })\r\n}","//NMB_HOST = '/adnmb';\r\n// const NMB_HOST = 'https://cors-anywhere.herokuapp.com/https://adnmb2.com/Api';\r\n// import jQuery from \"jquery\"\r\n// import $ from 'jquery'\r\nimport axios from \"axios\"\r\n\r\nexport default class Nmb {\r\n    // static NMB_HOST: string = 'http://www.chiro.work:2333/https://adnmb.com/Api';\r\n    static NMB_HOST: string = 'https://adnmb.com/Api';\r\n    static HOST: string = Nmb.NMB_HOST\r\n    static API_GET_FORUM_LIST: string = Nmb.NMB_HOST + '/getForumList/'\r\n    static API_THREAD: string = Nmb.NMB_HOST + '/thread/'\r\n    static API_SHOWF: string = Nmb.NMB_HOST + '/showf/'\r\n    static API_SEARCH: string = Nmb.NMB_HOST + '/Search/'\r\n    static CDN_IMG: string = 'https://nmbimg.fastmirror.org/image/'\r\n    static CDN_THUMB: string = 'https://nmbimg.fastmirror.org/thumb/'\r\n\r\n    static getThreadList(fid: number, page: number = 1) {\r\n        return axios.get(Nmb.API_SHOWF + '?id=' + fid + '&page=' + page)\r\n    }\r\n\r\n    static getTheard(tid: number, page: number = 1) {\r\n        return axios.get(Nmb.API_THREAD + '?id=' + tid + '&page=' + page)\r\n    }\r\n}\r\n\r\n\r\n// forums = []\r\n\r\n// // 在main.html才有效果\r\n// function nmbSetForumList(data) {\r\n//     //    console.log(data);\r\n//     forums = []\r\n//     data.sort((a, b) => {\r\n//         return a.sort > b.sort;\r\n//     });\r\n//     for (p of data) {\r\n//         p.forums.sort((a, b) => {\r\n//             return a.sort > b.sort;\r\n//         });\r\n//         forums = forums.concat(p.forums);\r\n//     }\r\n//     //    console.log(forums);\r\n//     forum_list.empty();\r\n//     forum_dom_t = $('<li class=\"mdui-list-item mdui-ripple\"><div class=\"mdui-list-item-content nmb-forum-content\"></div></li>');\r\n//     for (var i in forums) {\r\n//         var forum = forums[i];\r\n//         var forum_dom = $(forum_dom_t).clone(false, true);\r\n//         var target = forum.showName;\r\n//         if (!target)\r\n//             target = forum.name;\r\n//         $('.nmb-forum-content', forum_dom).html(target);\r\n//         $('.nmb-forum-content', forum_dom).attr('forum', JSON.stringify(forum));\r\n//         $('.nmb-forum-content', forum_dom).click(function () {\r\n//             console.log('click forum:', $(this));\r\n//             var mforum = JSON.parse($(this).attr('forum'));\r\n//             window.frames[0].fid = mforum.id;\r\n//             window.frames[0].page_now = 1;\r\n//             window.frames[0].thread_list.empty();\r\n//             nmbGetThreadList(mforum.id).then(d => {\r\n//                 $('.nmb-tag-' + window.frames[0].name).contents().find('.nmb-subtitle').text(mforum.name);\r\n//                 nmbSetThreadList(d);\r\n//             });\r\n//         });\r\n//         forum_list.append(forum_dom);\r\n//     }\r\n// }\r\n\r\n// function nmbGetForumList() {\r\n//     return $.ajax({\r\n//         url: SETTINGS.API_GET_FORUM_LIST,\r\n//         dataType: 'JSON'\r\n//     });\r\n// }\r\n\r\n// function nmbSetThreadList(data) {\r\n//     // mainActivity在stack的最下面\r\n//     var iframe = iframe_stack.data[0];\r\n//     window.frames[0].threadListLoad(data);\r\n// }\r\n\r\n// function nmbGetThreadList(fid, page = 1) {\r\n//     return $.ajax({\r\n//         url: SETTINGS.API_SHOWF + '?id=' + fid + '&page=' + page,\r\n//         dataType: 'JSON'\r\n//     });\r\n// }\r\n\r\n// function nmbGetTheard(tid, page = 1) {\r\n//     return $.ajax({\r\n//         url: SETTINGS.API_THREAD + '?id=' + tid + '&page=' + page,\r\n//         dataType: 'JSON'\r\n//     });\r\n// }","import moment from \"moment\"\r\n\r\nexport default {\r\n\tshowTimeInit: function () {\r\n\t\tmoment.locale('zh-cn', {\r\n\t\t\tmonths: '一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月'.split('_'),\r\n\t\t\tmonthsShort: '1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月'.split('_'),\r\n\t\t\tweekdays: '星期日_星期一_星期二_星期三_星期四_星期五_星期六'.split('_'),\r\n\t\t\tweekdaysShort: '周日_周一_周二_周三_周四_周五_周六'.split('_'),\r\n\t\t\tweekdaysMin: '日_一_二_三_四_五_六'.split('_'),\r\n\t\t\tlongDateFormat: {\r\n\t\t\t\tLT: 'HH:mm',\r\n\t\t\t\tLTS: 'HH:mm:ss',\r\n\t\t\t\tL: 'YYYY/MM/DD',\r\n\t\t\t\tLL: 'YYYY年MM月DD日',\r\n\t\t\t\tLLL: 'YYYY年MM月DD日Ah点mm分',\r\n\t\t\t\tLLLL: 'YYYY年MM月DD日ddddAh点mm分',\r\n\t\t\t\tl: 'YYYY/M/D',\r\n\t\t\t\tll: 'YYYY年M月D日',\r\n\t\t\t\tlll: 'YYYY年M月D日 HH:mm',\r\n\t\t\t\tllll: 'YYYY年M月D日dddd HH:mm'\r\n\t\t\t},\r\n\t\t\tmeridiemParse: /凌晨|早上|上午|中午|下午|晚上/,\r\n\t\t\tmeridiemHour: function (hour, meridiem) {\r\n\t\t\t\tif (hour === 12) {\r\n\t\t\t\t\thour = 0;\r\n\t\t\t\t}\r\n\t\t\t\tif (meridiem === '凌晨' || meridiem === '早上' ||\r\n\t\t\t\t\tmeridiem === '上午') {\r\n\t\t\t\t\treturn hour;\r\n\t\t\t\t} else if (meridiem === '下午' || meridiem === '晚上') {\r\n\t\t\t\t\treturn hour + 12;\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// '中午'\r\n\t\t\t\t\treturn hour >= 11 ? hour : hour + 12;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tmeridiem: function (hour, minute, isLower) {\r\n\t\t\t\tconst hm = hour * 100 + minute;\r\n\t\t\t\tif (hm < 600) {\r\n\t\t\t\t\treturn '凌晨';\r\n\t\t\t\t} else if (hm < 900) {\r\n\t\t\t\t\treturn '早上';\r\n\t\t\t\t} else if (hm < 1130) {\r\n\t\t\t\t\treturn '上午';\r\n\t\t\t\t} else if (hm < 1230) {\r\n\t\t\t\t\treturn '中午';\r\n\t\t\t\t} else if (hm < 1800) {\r\n\t\t\t\t\treturn '下午';\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn '晚上';\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcalendar: {\r\n\t\t\t\tsameDay: '[]LTS',\r\n\t\t\t\tnextDay: '[明天]LTS',\r\n\t\t\t\tnextWeek: '[下]ddddLTS',\r\n\t\t\t\tlastDay: '[昨天]LTS',\r\n\t\t\t\tlastWeek: '[上]ddddLTS',\r\n\t\t\t\tsameElse: 'L'\r\n\t\t\t},\r\n\t\t\tdayOfMonthOrdinalParse: /\\d{1,2}(日|月|周)/,\r\n\t\t\tordinal: function (number, period) {\r\n\t\t\t\tswitch (period) {\r\n\t\t\t\t\tcase 'd':\r\n\t\t\t\t\tcase 'D':\r\n\t\t\t\t\tcase 'DDD':\r\n\t\t\t\t\t\treturn number + '日';\r\n\t\t\t\t\tcase 'M':\r\n\t\t\t\t\t\treturn number + '月';\r\n\t\t\t\t\tcase 'w':\r\n\t\t\t\t\tcase 'W':\r\n\t\t\t\t\t\treturn number + '周';\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\treturn number;\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\trelativeTime: {\r\n\t\t\t\tfuture: '%s内',\r\n\t\t\t\tpast: '%s前',\r\n\t\t\t\ts: '几秒',\r\n\t\t\t\tss: '%d秒',\r\n\t\t\t\tm: '1分钟',\r\n\t\t\t\tmm: '%d分钟',\r\n\t\t\t\th: '1小时',\r\n\t\t\t\thh: '%d小时',\r\n\t\t\t\td: '1天',\r\n\t\t\t\tdd: '%d天',\r\n\t\t\t\tM: '1个月',\r\n\t\t\t\tMM: '%d个月',\r\n\t\t\t\ty: '1年',\r\n\t\t\t\tyy: '%d年'\r\n\t\t\t},\r\n\t\t\tweek: {\r\n\t\t\t\t// GB/T 7408-1994《数据元和交换格式·信息交换·日期和时间表示法》与ISO 8601:1988等效\r\n\t\t\t\tdow: 1, // Monday is the first day of the week.\r\n\t\t\t\tdoy: 4  // The week that contains Jan 4th is the first week of the year.\r\n\t\t\t}\r\n\t\t})\r\n\t},\r\n\tshowTime: function (utime) {\r\n\t\t// 注意是毫秒数\r\n\t\t// console.log(moment.locale())\r\n\t\tvar result = moment(utime).calendar()\r\n\t\treturn result\r\n\t},\r\n\r\n\tlimitString: function (string) {\r\n\t\tif (string.length > 15)\r\n\t\t\tstring = string.slice(0, 15) + '...'\r\n\t\tstring = string.replace('\\n', '')\r\n\t\treturn string\r\n\t},\r\n\r\n\tcolorHex: function (src) {\r\n\t\t// RGB颜色值的正则\r\n\t\tvar reg = /^(rgb|RGB)/;\r\n\t\tvar color = src;\r\n\t\tif (reg.test(color)) {\r\n\t\t\tvar strHex = \"#\";\r\n\t\t\t// 把RGB的3个数值变成数组\r\n\t\t\tvar colorArr = color.replace(/(?:\\(|\\)|rgb|RGB)*/g, \"\").split(\",\");\r\n\t\t\t// 转成16进制\r\n\t\t\tfor (var i = 0; i < colorArr.length; i++) {\r\n\t\t\t\tvar hex = Number(colorArr[i]).toString(16);\r\n\t\t\t\tif (hex === \"0\") {\r\n\t\t\t\t\thex += hex;\r\n\t\t\t\t}\r\n\t\t\t\tstrHex += hex;\r\n\t\t\t}\r\n\t\t\treturn strHex;\r\n\t\t} else {\r\n\t\t\treturn String(color);\r\n\t\t}\r\n\t}\r\n}","import React from 'react'\r\n// import { makeStyles, createStyles, withStyles, useTheme } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport DehazeIcon from '@material-ui/icons/Dehaze';\r\nimport Container from '@material-ui/core/Container';\r\nimport Paper from \"@material-ui/core/Paper\"\r\nimport Button from \"@material-ui/core/Button\"\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport grey from \"@material-ui/core/colors/grey\"\r\nimport red from \"@material-ui/core/colors/red\"\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport AtmIcon from '@material-ui/icons/Atm';\r\nimport GitHubIcon from '@material-ui/icons/GitHub';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport PlaylistAddIcon from '@material-ui/icons/PlaylistAdd';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport useScrollTrigger from '@material-ui/core/useScrollTrigger';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport KeyboardArrowUpIcon from '@material-ui/icons/KeyboardArrowUp';\r\nimport RestorePageIcon from '@material-ui/icons/RestorePage';\r\nimport Zoom from '@material-ui/core/Zoom';\r\n\r\n// import { PhotoSwipe, PhotoSwipeGallery, PhotoSwipeUI_Default } from 'react-photoswipe';\r\nimport _ from \"lodash\"\r\nimport Viewer from 'viewerjs';\r\nimport 'viewerjs/dist/viewer.css';\r\n\r\nimport Nmb from \"../nmb.ts\"\r\nimport utils from \"../utils\"\r\n\r\nfunction Alert(props) {\r\n  return <MuiAlert elevation={6} variant=\"filled\" {...props} />;\r\n}\r\nfunction ListItemLink(props) {\r\n  return <ListItem button component=\"a\" {...props} />;\r\n}\r\n\r\nfunction ScrollTop(props) {\r\n  const { children, window } = props;\r\n  // const classes = useStyles();\r\n  // Note that you normally won't need to set the window ref as useScrollTrigger\r\n  // will default to window.\r\n  // This is only being set here because the demo is in an iframe.\r\n  const trigger = useScrollTrigger({\r\n    target: window ? window() : undefined,\r\n    disableHysteresis: true,\r\n    threshold: 100,\r\n  });\r\n\r\n  const handleClick = (event) => {\r\n    const anchor = (event.target.ownerDocument || document).querySelector('#back-to-top-anchor');\r\n    // console.log('clicked!', anchor)\r\n\r\n    if (anchor) {\r\n      anchor.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Zoom in={trigger}>\r\n      <div onClick={handleClick} role=\"presentation\" style={{\r\n        position: 'fixed',\r\n        // bottom: theme.spacing(2),\r\n        // right: theme.spacing(2),\r\n        bottom: '3%',\r\n        right: '3%',\r\n      }}>\r\n        {children}\r\n      </div>\r\n    </Zoom>\r\n  );\r\n}\r\n\r\n\r\n\r\nexport default class Main extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    utils.showTimeInit()\r\n    // 绑定\r\n    this.toggleDrawer = this.toggleDrawer.bind(this)\r\n    this.addOldThreads = this.addOldThreads.bind(this)\r\n    this.saveNowThreads = this.saveNowThreads.bind(this)\r\n    this.fetchDone = this.fetchDone.bind(this)\r\n    this.addChosedOldThreads = this.addChosedOldThreads.bind(this)\r\n    // 速报版id是121\r\n    this.state = {\r\n      drawerOpen: false,\r\n      isLoading: true,\r\n      isImageOpen: false,\r\n      threads: [],\r\n      // 老串放在后面，新闻放在前面\r\n      localNowThreads: {},\r\n      imageLoaded: {},\r\n      // 多选模式\r\n      muiChoise: false,\r\n      // checkedThreads: {},\r\n    }\r\n    this.checkedThreads = {}\r\n    this.styles = {\r\n      cardHead: {\r\n        display: \"flex\",\r\n        width: \"100%\",\r\n        flexWrap: \"nowrap\",\r\n        justifyContent: \"space-between\",\r\n        color: grey[600]\r\n      },\r\n      cardHeadCookie: { display: \"inline-block\" },\r\n      cardHeadTime: { display: \"inline-block\", marginLeft: \"5px\" },\r\n      cardContentImage: { marginRight: \"5px\" },\r\n      cardImage: { maxWidth: '100px', maxHeight: '250px', display: 'inline-block' },\r\n      cardContent: { display: \"flex\" },\r\n      cardText: {},\r\n      menuButton: {\r\n        marginRight: 0,\r\n      },\r\n      title: {\r\n        flexGrow: 1,\r\n      },\r\n    }\r\n    // 获取致闻\r\n    this.oldThreads = JSON.parse(localStorage.getItem('oldThreads'))\r\n    if (this.oldThreads === undefined || this.oldThreads === null) {\r\n      this.oldThreads = {}\r\n      localStorage.setItem('oldThreads', JSON.stringify({}))\r\n    }\r\n    if (!localStorage.getItem('nowThreads')) {\r\n      localStorage.setItem('nowThreads', JSON.stringify([]))\r\n    }\r\n  }\r\n  // this问题的绑定\r\n  toggleDrawer() {\r\n    // console.log('toggleDrawer', this.toggleDrawer)\r\n    this.setState((pre) => {\r\n      return { drawerOpen: !pre.drawerOpen }\r\n    })\r\n  }\r\n\r\n  addOldThreads() {\r\n    for (let i of this.state.threads) {\r\n      this.oldThreads['' + i.id] = i\r\n    }\r\n    localStorage.setItem('oldThreads', JSON.stringify(this.oldThreads))\r\n    // // 刷新\r\n    // window.location.reload();\r\n    // 删除所有的串\r\n    this.setState({\r\n      threads: []\r\n    }, () => {\r\n      // 保存\r\n      localStorage.setItem('nowThreads', JSON.stringify(this.state.threads))\r\n    })\r\n  }\r\n\r\n  addChosedOldThreads() {\r\n    let tmp = _.cloneDeep(this.state.threads)\r\n    Object.keys(this.checkedThreads).forEach((key) => {\r\n      if (this.checkedThreads[key] !== true)\r\n        return\r\n      for (let i of tmp) {\r\n        if (i.id === key) {\r\n          tmp.remove(i)\r\n          this.oldThreads[i.id] = i\r\n          return\r\n        }\r\n      }\r\n    })\r\n    localStorage.setItem('oldThreads', JSON.stringify(this.oldThreads))\r\n    this.setState({\r\n      threads: tmp\r\n    }, () => {\r\n      // 保存\r\n      localStorage.setItem('nowThreads', JSON.stringify(this.state.threads))\r\n    })\r\n  }\r\n\r\n  // 单个标记致闻\r\n  addToOldThreads(thread) {\r\n    this.oldThreads['' + thread.id] = thread\r\n    localStorage.setItem('oldThreads', JSON.stringify(this.oldThreads))\r\n  }\r\n\r\n  // 保存正在浏览的串到本地储存\r\n  saveNowThreads() {\r\n    localStorage.setItem('nowThreads', JSON.stringify(this.state.threads))\r\n  }\r\n\r\n  // 删除本地数据\r\n  deleteOldThreads() {\r\n    localStorage.setItem('nowThreads', \"[]\")\r\n    localStorage.setItem('oldThreads', \"{}\")\r\n  }\r\n\r\n  // 组件第一次渲染完成\r\n  componentDidMount() {\r\n    // console.log('componentDidMount')\r\n    // console.log(JSON.parse(localStorage.getItem('nowThreads')))\r\n    // 获取上次没看完的串\r\n    let nowThreads = JSON.parse(localStorage.getItem('nowThreads'));\r\n    let localNowThreads = {}\r\n    for (let i of nowThreads) {\r\n      localNowThreads[i.id] = i.id\r\n    }\r\n    this.setState({\r\n      threads: nowThreads,\r\n      localNowThreads: localNowThreads\r\n    })\r\n    this.fetchData(1)\r\n  }\r\n\r\n  // 预先处理数据\r\n  preParse(data) {\r\n    // 直接处理字符串\r\n    data.now = Date.parse(data.now)\r\n    return data\r\n  }\r\n\r\n  // 当前数据排序\r\n  sortNowThreads() {\r\n    // console.log('called sortNowThreads')\r\n    this.setState((pre) => {\r\n      let tmp = _.cloneDeep(pre.threads).sort((a, b) => {\r\n        // fix : 获取到数据，插入的时候就排序\r\n        if (b.id < a.id)\r\n          return -1\r\n        else return 1\r\n      })\r\n      // console.log('threads', pre.threads)\r\n      // console.log('update state...tmp:', tmp)\r\n      return {\r\n        threads: tmp\r\n      }\r\n    }, () => {\r\n      this.saveNowThreads()\r\n    })\r\n  }\r\n\r\n  // 数据获取完成\r\n  fetchDone() {\r\n    this.setState((pre) => {\r\n      let tmp = _.cloneDeep(pre.threads).sort((a, b) => {\r\n        // fix : 获取到数据，插入的时候就排序\r\n        return b.now < a.now\r\n      })\r\n      // console.log('threads', pre.threads)\r\n      // console.log('tmp', tmp)\r\n      return {\r\n        isLoading: false,\r\n        threads: tmp\r\n      }\r\n    }, () => {\r\n      this.saveNowThreads()\r\n    })\r\n  }\r\n\r\n  fetchData(page) {\r\n    Nmb.getThreadList(121, page).then((data) => {\r\n      // console.log(data)\r\n      console.log('fetched page', page, 'got', data.data.length, 'thread(s)')\r\n      this.setState((pre) => {\r\n        let tmp = pre.threads\r\n        // 不考虑已经存在浏览区的串\r\n        let nowThreadsIds = {}\r\n        for (let j of this.state.threads)\r\n          nowThreadsIds[j.id] = true\r\n        for (let i of data.data) {\r\n          // tmp.push(i)\r\n          // 不考虑致闻\r\n          if (this.oldThreads['' + i.id] !== undefined)\r\n            continue\r\n          // 这个串是不是存在在浏览区\r\n          if (nowThreadsIds['' + i.id]) {\r\n            // 找到这个串\r\n            for (let j = 0; j < this.state.threads.length; j++) {\r\n              if (this.state.threads[j].id === i.id) {\r\n                // 找到了就替换\r\n                this.setState((pre) => {\r\n                  let tmp2 = _.cloneDeep(pre.threads)\r\n                  tmp2[j] = i\r\n                  return {\r\n                    threads: tmp2\r\n                  }\r\n                })\r\n                break\r\n              }\r\n            }\r\n          }\r\n          else\r\n            tmp.push(this.preParse(i))\r\n          // console.log(i)\r\n        }\r\n        return {\r\n          threads: tmp\r\n        }\r\n      })\r\n      // 排序\r\n      this.sortNowThreads();\r\n      if (data.data.length === 20)\r\n        this.fetchData(page + 1);\r\n      else {\r\n        // 数据获取完成\r\n        this.fetchDone();\r\n      }\r\n    })\r\n  }\r\n\r\n  createThreadCard(data) {\r\n    // admin: \"0\"\r\n    // content: \"美股开盘大跌<br />↵道琼斯直接熔断\"\r\n    // email: \"\"\r\n    // ext: \".jpg\"\r\n    // id: \"24579900\"\r\n    // img: \"2020-03-12/5e6a397c2ee8a\"\r\n    // name: \"无名氏\"\r\n    // now: \"2020-03-12(四)21:30:36\"\r\n    // remainReplys: 7572\r\n    // replyCount: \"7577\"\r\n    // replys: Array(5)\r\n    // 0: {id: \"29651016\", img: \"\", ext: \"\", now: \"2020-08-21(五)13:02:21\", userid: \"BfDs2WM\", …}\r\n    // 1: {id: \"29651143\", img: \"\", ext: \"\", now: \"2020-08-21(五)13:08:21\", userid: \"Jt6HhHm\", …}\r\n    // 2: {id: \"29651235\", img: \"\", ext: \"\", now: \"2020-08-21(五)13:12:03\", userid: \"3lY4U7o\", …}\r\n    // 3: {id: \"29692176\", img: \"\", ext: \"\", now: \"2020-08-22(六)21:01:25\", userid: \"EGWKZbU\", …}\r\n    // 4: {id: \"29706310\", img: \"\", ext: \"\", now: \"2020-08-23(日)10:25:12\", userid: \"gxIlxgf\", …}\r\n    // length: 5\r\n    // sage: \"0\"\r\n    // status: \"n\"\r\n    // title: \"无标题\"\r\n    // userid: \"L5EZGwy\"\r\n\r\n    // var tmpStyles = this.styles\r\n    let tmpStyles = _.cloneDeep(this.styles)\r\n    if (data.admin !== '0')\r\n      tmpStyles.cardHeadCookie.color = red[600]\r\n    let imgTop = (data.img !== undefined && data.img !== '') ? <img alt=\"\" style={tmpStyles.cardImage}\r\n      src={Nmb.CDN_THUMB + data.img + data.ext}\r\n      onClick={(event) => {\r\n        // 解决点击重叠问题\r\n        event.stopPropagation()\r\n        console.log(\"Image Clicked!\")\r\n        this.props.history.push('./image-viewer/' + window.btoa(Nmb.CDN_IMG + data.img + data.ext))\r\n      }}\r\n      className={'img' + window.btoa(data.img)}\r\n      style={tmpStyles.cardContentImage}\r\n    /> : undefined\r\n    let imgRes = imgTop\r\n\r\n    if (this.checkedThreads[data.id] === undefined)\r\n      this.checkedThreads[data.id] = false\r\n\r\n    let muiChoiseBox = (this.state.muiChoise && !data.maxWidth) ? <Checkbox\r\n      defaultChecked={false}\r\n      // checked={this.checkedThreads[data.id]}\r\n      // checked={checked}\r\n      onClick={(event) => {\r\n        event.stopPropagation()\r\n        // console.log('checkbox', event)\r\n        // this.setState((pre) => {\r\n        //   let tmp = _.cloneDeep(pre.checkedThreads)\r\n        //   tmp['' + data.id] = !tmp['' + data.id]\r\n        //   return {\r\n        //     checkedThreads: tmp\r\n        //   }\r\n        // })\r\n      }}\r\n      onChange={(event) => {\r\n        // console.log(_.cloneDeep(event))\r\n        // console.log(event.target.checked)\r\n        this.checkedThreads[data.id] = event.target.checked\r\n        // console.log(this.checkedThreads)\r\n      }}\r\n    // onClick={(event) => {\r\n    //   event.stopPropagation()\r\n    // }}\r\n    /> : undefined\r\n\r\n    return (\r\n      <Paper elevation={3} style={{\r\n        padding: \"10px\",\r\n        width: data.maxWidth ? \"100%\" : undefined\r\n      }}\r\n        onClick={() => {\r\n          console.log(\"Thread Clicked!\")\r\n          this.props.history.push('./thread/' + data.id)\r\n        }} >\r\n        <div style={tmpStyles.cardHead}>\r\n          <div>\r\n            <div style={tmpStyles.cardHeadCookie}>{data.userid}</div>\r\n            <div style={tmpStyles.cardHeadTime}>{utils.showTime(data.now)}</div>\r\n          </div>\r\n          <div className=\"card-head-count\">{data.replyCount}</div>\r\n          {muiChoiseBox}\r\n        </div>\r\n        <div style={tmpStyles.cardContent}>\r\n          <div>\r\n            {imgRes}\r\n          </div>\r\n          <div style={tmpStyles.cardText} dangerouslySetInnerHTML={{ __html: data.content }}></div>\r\n        </div>\r\n      </Paper>\r\n    )\r\n  }\r\n\r\n  render() {\r\n\r\n    let threads = []\r\n\r\n    // admin: \"0\"\r\n    // content: \"美股开盘大跌<br />↵道琼斯直接熔断\"\r\n    // email: \"\"\r\n    // ext: \".jpg\"\r\n    // id: \"24579900\"\r\n    // img: \"2020-03-12/5e6a397c2ee8a\"\r\n    // name: \"无名氏\"\r\n    // now: \"2020-03-12(四)21:30:36\"\r\n    // remainReplys: 7572\r\n    // replyCount: \"7577\"\r\n    // replys: Array(5)\r\n    // 0: {id: \"29651016\", img: \"\", ext: \"\", now: \"2020-08-21(五)13:02:21\", userid: \"BfDs2WM\", …}\r\n    // 1: {id: \"29651143\", img: \"\", ext: \"\", now: \"2020-08-21(五)13:08:21\", userid: \"Jt6HhHm\", …}\r\n    // 2: {id: \"29651235\", img: \"\", ext: \"\", now: \"2020-08-21(五)13:12:03\", userid: \"3lY4U7o\", …}\r\n    // 3: {id: \"29692176\", img: \"\", ext: \"\", now: \"2020-08-22(六)21:01:25\", userid: \"EGWKZbU\", …}\r\n    // 4: {id: \"29706310\", img: \"\", ext: \"\", now: \"2020-08-23(日)10:25:12\", userid: \"gxIlxgf\", …}\r\n    // length: 5\r\n    // sage: \"0\"\r\n    // status: \"n\"\r\n    // title: \"无标题\"\r\n    // userid: \"L5EZGwy\"\r\n\r\n    let progress = this.state.isLoading ? <LinearProgress color=\"secondary\" /> : <div />\r\n\r\n    for (let i of this.state.threads) {\r\n      // console.log(i)\r\n      threads.push(<div key={this.state.threads.indexOf(i)}>\r\n        {this.createThreadCard(i)}\r\n        <br />\r\n      </div>)\r\n      // if (i.id in this.state.localNowThreads) {\r\n      //   console.log('found', i.id, 'in', this.state.localNowThreads.length)\r\n      //   threads.push(<div key={this.state.threads.indexOf(i)}>\r\n      //     {this.createThreadCard(i)}\r\n      //     <br />\r\n      //   </div>)\r\n      // } else {\r\n      //   console.log('not found', i.id, 'in', this.state.localNowThreads.length)\r\n      //   // fix : 新串从头开始插入\r\n      //   threads = [<div key={this.state.threads.indexOf(i)}>\r\n      //     {this.createThreadCard(i)}\r\n      //     <br />\r\n      //   </div>].concat(threads)\r\n      // }\r\n    }\r\n\r\n    let empty = this.state.threads.length === 0 ? <div><br /><Alert severity=\"info\">你没有未看过的串，你没有致。</Alert></div> : <div />\r\n\r\n    let oldThreads = []\r\n    Object.keys(this.oldThreads).forEach((key) => {\r\n      let tmp = _.cloneDeep(this.oldThreads[key])\r\n      tmp.maxWidth = true\r\n      oldThreads.push(<div key={tmp.now}>\r\n        {this.createThreadCard(tmp)}\r\n        <br />\r\n      </div>)\r\n    })\r\n    oldThreads.reverse()\r\n\r\n    return (\r\n      <div className=\"root-main\" >\r\n        <Drawer open={this.state.drawerOpen} onClose={this.toggleDrawer}>\r\n          <div style={{ width: 240 + 'px' }}>\r\n            <List component=\"nav\" aria-label=\"main mailbox folders\">\r\n              <ListItemLink button href='https://adnmb.com/'>\r\n                <ListItemIcon>\r\n                  <AtmIcon />\r\n                </ListItemIcon>\r\n                <ListItemText primary=\"主站\" />\r\n              </ListItemLink>\r\n              <ListItemLink button href='https://gitee.com/chiro2001/ADNews'>\r\n                <ListItemIcon>\r\n                  <GitHubIcon />\r\n                </ListItemIcon>\r\n                <ListItemText primary=\"关于\" />\r\n              </ListItemLink>\r\n            </List>\r\n          </div>\r\n        </Drawer>\r\n        <AppBar>\r\n          {progress}\r\n          <Toolbar>\r\n            <IconButton edge=\"start\" style={this.styles.menuButton} color=\"inherit\" aria-label=\"menu\" onClick={this.toggleDrawer}>\r\n              <DehazeIcon></DehazeIcon>\r\n            </IconButton>\r\n            <Typography variant=\"h6\" style={this.styles.title}>\r\n              速报观察\r\n            </Typography>\r\n            <IconButton edge=\"start\" color=\"inherit\" onClick={() => {\r\n              // 删除所有储存数据然后刷新\r\n              this.deleteOldThreads();\r\n              window.location.reload();\r\n            }}>\r\n              <RestorePageIcon></RestorePageIcon>\r\n            </IconButton>\r\n            <IconButton edge=\"start\" color=\"inherit\" onClick={() => {\r\n              this.setState((pre) => {\r\n                return {\r\n                  muiChoise: !pre.muiChoise\r\n                }\r\n              })\r\n            }}>\r\n              <PlaylistAddIcon></PlaylistAddIcon>\r\n            </IconButton>\r\n            <IconButton edge=\"start\" color=\"inherit\" onClick={() => {\r\n              // 刷新\r\n              window.location.reload();\r\n            }}>\r\n              <RefreshIcon></RefreshIcon>\r\n            </IconButton>\r\n          </Toolbar>\r\n        </AppBar>\r\n\r\n        {/* 一个AppBar高度 */}\r\n        <div style={{ marginTop: 64 + 'px' }} id=\"back-to-top-anchor\"></div>\r\n\r\n        <div className=\"container-main\">\r\n          <Container className=\"thread\">\r\n            {empty}\r\n            <br />\r\n            {threads}\r\n            <Accordion>\r\n              <AccordionSummary\r\n                expandIcon={<ExpandMoreIcon />}\r\n                aria-controls=\"panel1a-content\"\r\n                aria-label=\"Expand\"\r\n                id=\"panel1a-header\"\r\n              >\r\n                <div>\r\n                  <Typography style={this.styles.heading} color='primary'>致闻</Typography>\r\n                  <Button aria-label=\"Acknowledge\" color=\"primary\"\r\n                    onClick={(event) => {\r\n                      event.stopPropagation()\r\n                      this.addOldThreads()\r\n                    }}\r\n                    onFocus={(event) => event.stopPropagation()}>把上面所有串加入致闻</Button>\r\n                  <Button aria-label=\"Acknowledge\" color=\"primary\"\r\n                    onClick={(event) => {\r\n                      event.stopPropagation()\r\n                      this.addChosedOldThreads()\r\n                    }}\r\n                    onFocus={(event) => event.stopPropagation()}\r\n                    style={{ display: this.state.muiChoise ? \"block\" : \"none\" }}>将勾选串加入致闻</Button>\r\n                </div>\r\n              </AccordionSummary>\r\n              <AccordionDetails>\r\n                <Container>\r\n                  {oldThreads}\r\n                </Container>\r\n              </AccordionDetails>\r\n            </Accordion>\r\n          </Container>\r\n        </div>\r\n        <ScrollTop {...this.props}>\r\n          <Fab color=\"secondary\" size=\"small\" aria-label=\"scroll back to top\">\r\n            <KeyboardArrowUpIcon />\r\n          </Fab>\r\n        </ScrollTop>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\n\r\n","import React from 'react'\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport Container from '@material-ui/core/Container';\r\nimport Paper from \"@material-ui/core/Paper\"\r\nimport Button from \"@material-ui/core/Button\"\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport grey from \"@material-ui/core/colors/grey\"\r\nimport red from \"@material-ui/core/colors/red\"\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport Viewer from 'viewerjs';\r\nimport 'viewerjs/dist/viewer.css';\r\n\r\nimport Nmb from \"../nmb.ts\"\r\nimport utils from \"../utils\"\r\n\r\n// import Nmb from \"../nmb.ts\"\r\n\r\nexport default class ImageViewer extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    console.log(props)\r\n    console.log(this.props)\r\n    console.log(this.props.routeParams)\r\n    this.url = window.atob(props.match.params._url)\r\n    console.log('url', this.url)\r\n  }\r\n\r\n  render() {\r\n    let viewer = undefined\r\n    return (\r\n      <div style={{ height: \"100%\" }}>\r\n        <AppBar position=\"static\">\r\n          <Toolbar>\r\n            <IconButton edge=\"start\" color=\"inherit\" aria-label=\"menu\" onClick={() => {\r\n              this.props.history.go(-1)\r\n            }}>\r\n              <ArrowBackIcon></ArrowBackIcon>\r\n            </IconButton>\r\n          </Toolbar>\r\n        </AppBar>\r\n        <br />\r\n        <Container>\r\n          <div style={{ height: \"100%\", margin: 'auto' }}>\r\n            <img id=\"image\" alt=\"\" src={this.url} style={{ width: \"100%\" }}\r\n            // onLoad={() => {\r\n            //   viewer = new Viewer(document.querySelectorAll('#image')[0], {\r\n            //     inline: true,\r\n            //     viewed() {\r\n            //       viewer.zoomTo(1);\r\n            //     },\r\n            //   });\r\n            // }}\r\n            />\r\n          </div>\r\n        </Container>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\n\r\n","import React from 'react';\nimport './App.css';\nimport Drawer from '@material-ui/core/Drawer';\n// 这里要用BrowserRouter\nimport { BrowserRouter as Router, Route, Link } from 'react-router-dom'\nimport { ThemeProvider } from '@material-ui/core/styles';\nimport { Button } from \"@material-ui/core\"\n\nimport { Config } from \"./config.ts\"\n\nimport Main from \"./components/main\"\nimport ImageViewer from \"./components/image-viewer\"\n\n\nexport default class App extends React.Component {\n  constructor(props) {\n    super(props);\n    // this.state = {\n    //   drawerOpen: false\n    // }\n    // // 绑定\n    // this.toggleDrawer = this.toggleDrawer.bind(this)\n  }\n  // // this问题的绑定\n  // toggleDrawer() {\n  //   // console.log('toggleDrawer', this.toggleDrawer)\n  //   this.setState((pre) => {\n  //     return { drawerOpen: !pre.drawerOpen }\n  //   })\n  // }\n  render() {\n    return (\n      // <ThemeProvider theme={Config.theme}>\n      //   <Drawer open={this.state.drawerOpen} onClose={this.toggleDrawer}>\n      //     <div style={{ width: 240 + 'px' }}>TEST</div>\n      //   </Drawer>\n      //   <h1>drawerOpen: {'' + this.state.drawerOpen}</h1>\n      //   <Button variant=\"contained\" color=\"primary\" onClick={this.toggleDrawer}>Open Drawer</Button>\n      // </ThemeProvider>\n      <div />\n    );\n  }\n}\n","import React from 'react'\r\nimport ReactDOM from 'react-dom';\r\nimport { Router, Route, Link } from 'react-router-dom'\r\n// import { makeStyles, createStyles, withStyles, useTheme } from '@material-ui/core/styles';\r\nimport AppBar from '@material-ui/core/AppBar';\r\nimport Toolbar from '@material-ui/core/Toolbar';\r\nimport IconButton from '@material-ui/core/IconButton';\r\nimport Typography from '@material-ui/core/Typography';\r\nimport DehazeIcon from '@material-ui/icons/Dehaze';\r\nimport Container from '@material-ui/core/Container';\r\nimport Paper from \"@material-ui/core/Paper\"\r\nimport Button from \"@material-ui/core/Button\"\r\nimport Accordion from '@material-ui/core/Accordion';\r\nimport AccordionSummary from '@material-ui/core/AccordionSummary';\r\nimport AccordionDetails from '@material-ui/core/AccordionDetails';\r\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\r\nimport grey from \"@material-ui/core/colors/grey\"\r\nimport red from \"@material-ui/core/colors/red\"\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport List from '@material-ui/core/List';\r\nimport ListItem from '@material-ui/core/ListItem';\r\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\r\nimport ListItemText from '@material-ui/core/ListItemText';\r\nimport AtmIcon from '@material-ui/icons/Atm';\r\nimport GitHubIcon from '@material-ui/icons/GitHub';\r\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack';\r\nimport RefreshIcon from '@material-ui/icons/Refresh';\r\nimport PlaylistAddIcon from '@material-ui/icons/PlaylistAdd';\r\nimport Drawer from '@material-ui/core/Drawer';\r\nimport Divider from '@material-ui/core/Divider';\r\nimport useScrollTrigger from '@material-ui/core/useScrollTrigger';\r\nimport MuiAlert from '@material-ui/lab/Alert';\r\nimport Checkbox from '@material-ui/core/Checkbox';\r\nimport Fab from '@material-ui/core/Fab';\r\nimport KeyboardArrowUpIcon from '@material-ui/icons/KeyboardArrowUp';\r\nimport Zoom from '@material-ui/core/Zoom';\r\nimport $ from 'jQuery'\r\n\r\n// import { PhotoSwipe, PhotoSwipeGallery, PhotoSwipeUI_Default } from 'react-photoswipe';\r\nimport _ from \"lodash\"\r\nimport Viewer from 'viewerjs';\r\nimport 'viewerjs/dist/viewer.css';\r\n\r\nimport Nmb from \"../nmb.ts\"\r\nimport utils from \"../utils\"\r\n// import { Link } from '@material-ui/core';\r\n\r\n\r\nfunction ListItemLink(props) {\r\n  return <ListItem button component=\"a\" {...props} />;\r\n}\r\n\r\n\r\nexport default class Thread extends React.Component {\r\n  constructor(props) {\r\n    super(props)\r\n    // 绑定\r\n    this.fetchData = this.fetchData.bind(this)\r\n    this.id = props.match.params.id\r\n    if (this.id === undefined)\r\n      this.props.history.go(-1)\r\n    this.styles = {\r\n      cardHead: {\r\n        display: \"flex\",\r\n        width: \"100%\",\r\n        flexWrap: \"nowrap\",\r\n        justifyContent: \"space-between\",\r\n        color: grey[600]\r\n      },\r\n      cardHeadCookie: { display: \"inline-block\" },\r\n      cardHeadTime: { display: \"inline-block\", marginLeft: \"5px\" },\r\n      cardContentImage: { marginRight: \"5px\" },\r\n      cardImage: { maxWidth: '150px', maxHeight: '350px', display: 'inline-block' },\r\n      cardContent: { display: \"flex\" },\r\n      cardText: { width: '100%' },\r\n      menuButton: {\r\n        marginRight: 0,\r\n      },\r\n      title: {\r\n        flexGrow: 1,\r\n        lineHeight: 1.5,\r\n      },\r\n      subTitle: {\r\n        color: grey[300],\r\n        lineHeight: 1,\r\n      },\r\n\r\n    }\r\n    this.state = {\r\n      isLoading: true,\r\n      replys: [],\r\n    }\r\n    this.fetchData(1)\r\n    this.replys = {}\r\n  }\r\n\r\n  parseQuote(src) {\r\n    // 去除开头的>号\r\n    while (src[0] === '>' && src.length > 0)\r\n      src = src.replace('>', '')\r\n    if (!src.startsWith('No.'))\r\n      return '0'\r\n    src = src.replace('No.', '')\r\n    return src\r\n  }\r\n\r\n  // 动态生成原生dom\r\n  createNativeQuote(data, options) {\r\n    if (!options)\r\n      options = {}\r\n    let styleQuote = {\r\n      borderLeft: '5px solid ' + utils.colorHex('rgb(99,190,183)'),\r\n      background: utils.colorHex('rgb(224,242,242)'),\r\n      // padding: \"5px 10px\",\r\n      margin: '0px 0px 0px 15px',\r\n      color: 'black'\r\n    }\r\n    let innerHTML = ''\r\n    let element = <blockquote style={styleQuote}>\r\n      {this.createReply(data, {\r\n        noShowDivider: true,\r\n        noShowId: true,\r\n        showJump: options.showJump,\r\n      })}\r\n    </blockquote>\r\n    let tmp = $('<div></div>')\r\n    ReactDOM.render(element, tmp[0])\r\n    // hydrate没用\r\n    // ReactDOM.hydrate(element, tmp[0])\r\n    // console.log(tmp, $(tmp).html())\r\n    innerHTML = $(tmp).html()\r\n    return innerHTML\r\n  }\r\n\r\n  fetchData(page) {\r\n    Nmb.getTheard(this.id, page).then((response) => {\r\n      let data = response.data\r\n      this.po = data\r\n      if (!data.replys) {\r\n        console.log('data.replys undefined', data)\r\n        this.setState({ isLoading: false })\r\n        return\r\n      }\r\n      console.log('getTheard', this.id, 'fertched', data.replys.length, 'reply(s)')\r\n      this.setState((pre) => {\r\n        let tmp = _.cloneDeep(pre.replys)\r\n        for (let reply of data.replys) {\r\n          tmp.push(reply)\r\n          this.replys[reply.id] = reply\r\n        }\r\n        return {\r\n          replys: tmp\r\n        }\r\n      }, () => {\r\n        // 设置全局的<font>点击事件\r\n        $('font').click((event) => {\r\n          // console.log($(event.target).text())\r\n          if (event.target.nodeName !== 'FONT')\r\n            return\r\n          // console.log(event)\r\n          let src = $(event.target).text()\r\n          let targetId = '' + this.parseQuote(src)\r\n          // 如果找到\r\n          if (this.replys[targetId]) {\r\n            let data = this.replys[targetId]\r\n            $(event.target).html($(event.target).html() + this.createNativeQuote(data))\r\n          }\r\n          // 找不到就另开\r\n          else {\r\n            $(event.target).off('click')\r\n            Nmb.getTheard(targetId, 1).then((response) => {\r\n              // console.log(response)\r\n              if (response.data.content)\r\n                $(event.target).html($(event.target).html() + this.createNativeQuote(response.data, {\r\n                  showJump: true\r\n                }))\r\n              else\r\n                $(event.target).html('<span style=\"color: red\">(该主题不存在)</span>')\r\n            })\r\n          }\r\n        })\r\n      })\r\n      if (data.replys.length <= 20)\r\n        this.setState({ isLoading: false })\r\n      setTimeout(function () {\r\n        // console.log('excute click')\r\n        $('font').click();\r\n      }, 500)\r\n    })\r\n  }\r\n\r\n  createReply(data, options) {\r\n    if (options === undefined)\r\n      // 默认全部是false\r\n      options = {\r\n        noShowId: false,\r\n        noShowDivider: false,\r\n        showJump: false,\r\n      }\r\n    if (data === undefined)\r\n      return undefined\r\n    // 过滤广告\r\n    // console.log('createReply', data)\r\n    if (data.id == 9999999)\r\n      return undefined\r\n    let tmpStyles = _.cloneDeep(this.styles)\r\n    if (data.admin !== '0') {\r\n      tmpStyles.cardHeadCookie.color = red[600]\r\n      tmpStyles.cardHeadCookie.fontWeight = 600\r\n    }\r\n    // console.log('createReply', data)\r\n    if (data.userid == this.po.userid) {\r\n      tmpStyles.cardHeadCookie.color = 'black'\r\n      tmpStyles.cardHeadCookie.fontWeight = 600\r\n    }\r\n\r\n\r\n    let imgRes = (data.img !== undefined && data.img !== '') ? <img alt=\"\" style={tmpStyles.cardImage}\r\n      src={Nmb.CDN_THUMB + data.img + data.ext}\r\n      onClick={(event) => {\r\n        // 解决点击重叠问题\r\n        event.stopPropagation()\r\n        // console.log(\"Image Clicked!\")\r\n        this.props.history.push('../image-viewer/' + window.btoa(Nmb.CDN_IMG + data.img + data.ext))\r\n      }}\r\n      className={'img' + window.btoa(data.img)}\r\n      style={tmpStyles.cardContentImage}\r\n    /> : undefined\r\n\r\n    let contentDom = undefined\r\n\r\n    if (data.content) {\r\n      // 默认展开第一层引用\r\n      let contentHtml = data.content.replace(/<\\/font><br \\/>/g, '</font>')\r\n      contentDom = $('<div>' + contentHtml + '</div>')\r\n      let query = $('font', contentDom)\r\n      if (query.length > 0) {\r\n        // // 只有一个font元素\r\n        // let font = query[0]\r\n        // console.log('get font', font, data)\r\n        // let targetId = this.parseQuote($(font).text())\r\n        // if (this.replys[targetId]) {\r\n        //   let data = this.replys[targetId]\r\n        //   $('font', contentDom).html($(font).html() + this.createNativeQuote(data))\r\n        //   console.log('set font', this.createNativeQuote(data))\r\n        // }\r\n      }\r\n    } else {\r\n      console.log('content undefined', data)\r\n      contentDom = $('<div>' + data.content + '</div>')\r\n    }\r\n    // console.log(contentDom.html())\r\n\r\n    let content = <div style={tmpStyles.cardText}\r\n      dangerouslySetInnerHTML={{ __html: $(contentDom).html() }}></div>\r\n    // console.log(content)\r\n    let userid = options.noShowId ? undefined : 'No.' + data.id\r\n    let divider = options.noShowDivider ? undefined : <Divider light />\r\n    // let jump = options.showJump ? <a href={'javascript: history.pushState(\"/thread/\" + ' + data.id + ')'}>跳转该串</a> : undefined\r\n    let jump = undefined\r\n\r\n    return (\r\n      <div>\r\n        <div style={{\r\n          padding: \"10px\",\r\n          // width: \"100%\"\r\n        }}>\r\n          <div style={tmpStyles.cardHead}>\r\n            <div>\r\n              <div style={tmpStyles.cardHeadCookie}>{data.userid}</div>\r\n              <div style={tmpStyles.cardHeadTime}>{utils.showTime(data.now)}</div>\r\n            </div>\r\n            {/* <Link href={'/thread/' + data.id}>跳转该串</Link> */}\r\n            <div>{userid}{jump}</div>\r\n          </div>\r\n          <div style={tmpStyles.cardContent}>\r\n            <div>\r\n              {imgRes}\r\n            </div>\r\n            {content}\r\n          </div>\r\n        </div>\r\n        {divider}\r\n      </div>\r\n    )\r\n  }\r\n\r\n  render() {\r\n    let progress = this.state.isLoading ? <LinearProgress color=\"secondary\" /> : <div />\r\n    let replys = [this.createReply(this.po)]\r\n    for (let r of this.state.replys)\r\n      replys.push(<div key={r.id}>\r\n        {this.createReply(r)}\r\n      </div>)\r\n\r\n    return (\r\n      <div className=\"root-thread\">\r\n        <AppBar>\r\n          {progress}\r\n          <Toolbar id=\"back-to-top-anchor\">\r\n            <IconButton edge=\"start\" color=\"inherit\" aria-label=\"menu\" onClick={() => {\r\n              this.props.history.go(-1)\r\n            }}>\r\n              <ArrowBackIcon></ArrowBackIcon>\r\n            </IconButton>\r\n            <div>\r\n              <Typography variant=\"h6\" style={this.styles.title}>\r\n                速报观察\r\n              </Typography>\r\n              {/* <Typography variant=\"h6\">\r\n                {'No.' + this.id}\r\n              </Typography> */}\r\n              <Typography variant=\"caption\" display=\"block\" gutterBottom style={this.styles.subTitle}>\r\n                {'>>No.' + this.id}\r\n              </Typography>\r\n            </div>\r\n          </Toolbar>\r\n        </AppBar>\r\n\r\n        {/* 一个AppBar高度 */}\r\n        <div style={{ marginTop: 64 + 'px' }}></div>\r\n\r\n        {/* {progress} */}\r\n\r\n        <div className=\"container-main\">\r\n          <div>\r\n            {replys}\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n// import Drawer from '@material-ui/core/Drawer';\n// 这里要用BrowserRouter\nimport { BrowserRouter as Router, Route, Redirect } from 'react-router-dom'\nimport { ThemeProvider } from '@material-ui/core/styles';\n\nimport { Config } from \"./config.ts\"\n\nimport Main from \"./components/main\"\nimport Thread from \"./components/thread\"\nimport ImageViewer from \"./components/image-viewer\"\nimport * as serviceWorker from './serviceWorker';\n\n// ReactDOM.render(\n//   // <React.StrictMode>\n//     <App />,\n//   // </React.StrictMode>,\n//   document.getElementById('root')\n// );\n\nArray.prototype.remove = function (val) {\n  var index = this.indexOf(val);\n  if (index > -1) {\n    this.splice(index, 1);\n  }\n};\n\nlet path_prefix = '/android_asset/www/'\n\nReactDOM.render(\n  <ThemeProvider theme={Config.theme}>\n    <Router>\n      <Route path={path_prefix + 'adnews/thread/:id'} component={Thread} />\n      <Route path={path_prefix + 'adnews/image-viewer/:_url'} component={ImageViewer} />\n      <Route path={path_prefix + 'adnews/index.html'} component={Main} />\n      {/* <Redirect from={path_prefix + \"adnews/index.html\"} to={path_prefix + 'adnews/index.html'} /> */}\n      {/* <Redirect from=\"/\" to=\"/adnews\" />\n      <Redirect from=\"/adnews\" to=\"/adnews/main\" /> */}\n    </Router>\n  </ThemeProvider>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n\n"],"sourceRoot":""}